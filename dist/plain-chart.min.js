/*!
 * plain-chart - 一个比 Apache ECharts 更简单的开源可视化图表库
 * git+https://github.com/clunch-contrib/chart.git
 *
 * author 你好2007 < https://hai2007.github.io/SweetHome >
 *
 * version 1.0.2
 *
 * Copyright (c) 2021-2022 hai2007 走一步，再走一步。
 * Released under the MIT license
 *
 * Date:Mon May 30 2022 19:58:00 GMT+0800 (GMT+08:00)
 */
(function(){"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function(obj){return typeof obj}}else{_typeof=function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function(){};return{s:F,n:function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function(){it=it.call(o)},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(e){didErr=true;err=e},f:function(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}var image=[{name:"group",attrs:{"c-for":"(option,order) in options"},children:[{name:"text",attrs:{"c-if":"option.title",":x":"option.grid.x+option.title.x",":y":"option.grid.y+option.title.y",":content":"option.title.value",":fill-color":"option.title.color",":font-size":'option.title["font-size"]',":align":"option.title.align",":baseline":"option.title.baseline"},children:[]},{name:"ruler",attrs:{"c-if":"option.xAxis",":x":"option.grid.x+option.grid.left",":y":"option.grid.y+option.grid.height-option.grid.bottom",":length":"option.grid.width-option.grid.left-option.grid.right",direction:"LR","mark-direction":"right","value-position":"between",":value":"option.xAxis.values"},children:[]},{name:"ruler",attrs:{"c-if":"option.yAxis",":x":"option.grid.x+option.grid.left",":y":"option.grid.y+option.grid.height-option.grid.bottom",":length":"option.grid.height-option.grid.top-option.grid.bottom",direction:"BT","mark-direction":"left","value-position":"mark",":value":"option.yAxis.values"},children:[]},{name:"plain-chart-tree",attrs:{"c-if":'option.type=="tree"',":order":"order",":cx":"option.grid.x+option.grid.left+(option.grid.width-option.grid.left-option.grid.right)*0.5",":cy":"option.grid.y+option.grid.top+(option.grid.height-option.grid.top-option.grid.bottom)*0.5",":radius":"option.grid.x+(option.grid.width-option.grid.left-option.grid.right)*0.5\n            >\n            option.grid.y+(option.grid.height-option.grid.top-option.grid.bottom)*0.5\n            ?\n            option.grid.y+(option.grid.height-option.grid.top-option.grid.bottom)*0.5\n            :\n            option.grid.x+(option.grid.width-option.grid.left-option.grid.right)*0.5",":x":"option.grid.x+option.grid.left",":y":"option.grid.y+option.grid.bottom",":width":"option.grid.width-option.grid.left-option.grid.right",":height":"option.grid.height-option.grid.top-option.grid.bottom",":data":"option.treeData",":type":"option.treeType"},children:[]},{name:"plain-chart-map",attrs:{"c-if":'option.type=="map"',":order":"order",":cx":"option.grid.x+option.grid.left+(option.grid.width-option.grid.left-option.grid.right)*0.5",":cy":"option.grid.y+option.grid.top+(option.grid.height-option.grid.top-option.grid.bottom)*0.5",":width":"option.grid.width-option.grid.left-option.grid.right",":height":"option.grid.height-option.grid.top-option.grid.bottom",":geo-json":"option.geo"},children:[]},{name:"plain-chart-bar",attrs:{"c-if":'option.type=="bar"',":order":"order",":x":"option.grid.x+option.grid.left",":y":"option.grid.y+option.grid.height-option.grid.bottom",":width":"option.grid.width-option.grid.left-option.grid.right",":height":"option.grid.height-option.grid.top-option.grid.bottom",":data":"option.series"},children:[]},{name:"plain-chart-line",attrs:{"c-if":'option.type=="line"',":order":"order",":x":"option.grid.x+option.grid.left",":y":"option.grid.y+option.grid.height-option.grid.bottom",":width":"option.grid.width-option.grid.left-option.grid.right",":height":"option.grid.height-option.grid.top-option.grid.bottom",":data":"option.series"},children:[]},{name:"plain-chart-pie",attrs:{"c-if":'option.type=="pie" || option.type=="ring"',":order":"order",":cx":"option.grid.x+option.grid.left+(option.grid.width-option.grid.left-option.grid.right)*0.5",":cy":"option.grid.y+option.grid.top+(option.grid.height-option.grid.top-option.grid.bottom)*0.5",":radius":"option.grid.x+(option.grid.width-option.grid.left-option.grid.right)*0.5\n            >\n            option.grid.y+(option.grid.height-option.grid.top-option.grid.bottom)*0.5\n            ?\n            option.grid.y+(option.grid.height-option.grid.top-option.grid.bottom)*0.5\n            :\n            option.grid.x+(option.grid.width-option.grid.left-option.grid.right)*0.5",":values":"option.series.values",":names":"option.series.names",":type":"option.type"},children:[]}]}];function _isObject(value){var type=_typeof(value);return value!=null&&(type==="object"||type==="function")}var toString=Object.prototype.toString;function getType(value){if(value==null){return value===undefined?"[object Undefined]":"[object Null]"}return toString.call(value)}function _isNumber(value){return typeof value==="number"||value!==null&&_typeof(value)==="object"&&getType(value)==="[object Number]"}function _isString(value){var type=_typeof(value);return type==="string"||type==="object"&&value!=null&&!Array.isArray(value)&&getType(value)==="[object String]"}function _isFunction(value){if(!_isObject(value)){return false}var type=getType(value);return type==="[object Function]"||type==="[object AsyncFunction]"||type==="[object GeneratorFunction]"||type==="[object Proxy]"}
/*!
   * 💡 - 值类型判断方法
   * https://github.com/hai2007/tool.js/blob/master/type.js
   *
   * author hai2007 < https://hai2007.gitee.io/sweethome >
   *
   * Copyright (c) 2020-present hai2007 走一步，再走一步。
   * Released under the MIT license
   */var isObject=_isObject;var isNumber=_isNumber;var isString=_isString;var isFunction=_isFunction;var isArray=function isArray(input){return Array.isArray(input)};function format(option,clunch,$ruler){var formatOption={};var grid=option.grid||{};formatOption.grid={x:"x"in grid?grid.x:0,y:"y"in grid?grid.y:0,width:"width"in grid?grid.width:clunch._width,height:"height"in grid?grid.height:clunch._height,left:"left"in grid?grid.left:50,right:"right"in grid?grid.right:50,top:"top"in grid?grid.top:50,bottom:"bottom"in grid?grid.bottom:50};if(option.title){var title=option.title;formatOption.title={x:"x"in title?title.x:20,y:"y"in title?title.y:50,value:"value"in title?title.value:"","font-size":"font-size"in title?title["font-size"]:16,color:"color"in title?title.color:"#000",align:"align"in title?title.align:"left",baseline:"baseline"in title?title.baseline:"middle"}}else{formatOption.title=false}if(["bar","line","pie","ring","map","tree"].indexOf(option.type)>-1){formatOption.type=option.type}else{formatOption.type="none"}var _values=[];var _names=[];if(["map"].indexOf(formatOption.type)>-1){formatOption.geo=option.data}else if(["tree"].indexOf(formatOption.type)>-1){formatOption.treeData=option.data;var treeConfig=option.tree||{};formatOption.treeType=treeConfig.direction||"TB"}else if(option.data){if(isNumber(option.data[0])){_values=option.data}else{var _iterator=_createForOfIteratorHelper(option.data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;_values.push(item.value);_names.push(item.name)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}}formatOption.series={values:_values,names:_names};if(["bar","line"].indexOf(formatOption.type)>-1){var xAxis=option.xAxis||{};formatOption.xAxis={values:"values"in xAxis?xAxis.values:_names};var yAxis=option.yAxis||{};formatOption.yAxis={values:yAxis.values};if(!formatOption.yAxis.values){var max=_values[0];var min=_values[0];var _iterator2=_createForOfIteratorHelper(_values),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var value=_step2.value;if(value>max)max=value;if(value<min)min=value}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}formatOption.yAxis.values=$ruler(max,min,5).ruler}formatOption.series.min=formatOption.yAxis.values[0];formatOption.series.max=formatOption.yAxis.values[formatOption.yAxis.values.length-1];if(!option.xAxis||!(formatOption.xAxis&&formatOption.xAxis.values&&formatOption.xAxis.values.length>0))formatOption.xAxis=false;if(!option.yAxis||!(formatOption.yAxis&&formatOption.yAxis.values&&formatOption.yAxis.values.length>0))formatOption.yAxis=false}else{formatOption.xAxis=false;formatOption.yAxis=false}return formatOption}var $RegExp={blankReg:new RegExp("[\\x20\\t\\r\\n\\f]"),blanksReg:/^[\x20\t\r\n\f]{0,}$/,identifier:/^[a-zA-Z_$][0-9a-zA-Z_$]{0,}$/};var specialCode1=["+","-","*","/","%","&","|","!","?",":","[","]","(",")",">","<","="];var specialCode2=["+","-","*","/","%","&","|","!","?",":",">","<","=","<=",">=","==","===","!=","!=="];function analyseExpress(target,express,scope){express=express.trim();var i=-1,currentChar=null;var next=function next(){currentChar=i++<express.length-1?express[i]:null;return currentChar};var nextNValue=function nextNValue(n){return express.substring(i,n+i>express.length?express.length:n+i)};next();var expressArray=[];while(true){if(i>=express.length)break;if(specialCode1.indexOf(currentChar)>-1){if(["&","|","="].indexOf(currentChar)>-1){if(["==="].indexOf(nextNValue(3))>-1){expressArray.push(nextNValue(3));i+=2;next()}else if(["&&","||","=="].indexOf(nextNValue(2))>-1){expressArray.push(nextNValue(2));i+=1;next()}else{throw new Error("Illegal expression : "+express+"\nstep='analyseExpress',index="+i)}}else{if(["!=="].indexOf(nextNValue(3))>-1){expressArray.push(nextNValue(3));i+=2;next()}else if([">=","<=","!="].indexOf(nextNValue(2))>-1){expressArray.push(nextNValue(2));i+=1;next()}else{expressArray.push(currentChar);next()}}}else if(['"',"'"].indexOf(currentChar)>-1){var temp="",beginTag=currentChar;next();while(currentChar!=beginTag){if(i>=express.length){throw new Error("String unclosed error : "+express+"\nstep='analyseExpress',index="+i)}temp+=currentChar;next()}expressArray.push(temp+"@string");next()}else if(/\d/.test(currentChar)){var dotFlag="no";var temp=currentChar;next();while(i<express.length){if(/\d/.test(currentChar)){temp+=currentChar;if(dotFlag=="error")dotFlag="yes"}else if("."==currentChar&&dotFlag=="no"){temp+=currentChar;dotFlag="error"}else{break}next()}if(dotFlag=="error")temp+="0";expressArray.push(+temp)}else if(["null","true"].indexOf(nextNValue(4))>-1){expressArray.push({null:null,true:true}[nextNValue(4)]);i+=3;next()}else if(["false"].indexOf(nextNValue(5))>-1){expressArray.push({false:false}[nextNValue(5)]);i+=4;next()}else if(["undefined"].indexOf(nextNValue(9))>-1){expressArray.push({undefined:undefined}[nextNValue(9)]);i+=8;next()}else if($RegExp.blankReg.test(currentChar)){do{next()}while($RegExp.blankReg.test(currentChar)&&i<express.length)}else{var dot=false;if(currentChar=="."){dot=true;next()}if($RegExp.identifier.test(currentChar)){var len=1;while(i+len<=express.length&&$RegExp.identifier.test(nextNValue(len))){len+=1}if(dot){expressArray.push("[");expressArray.push(nextNValue(len-1)+"@string");expressArray.push("]")}else{var tempKey=nextNValue(len-1);var tempValue=tempKey in scope?scope[tempKey]:target[tempKey];expressArray.push(isString(tempValue)?tempValue+"@string":tempValue)}i+=len-2;next()}else{throw new Error("Illegal express : "+express+"\nstep='analyseExpress',index="+i)}}}var length=0;for(var j=0;j<expressArray.length;j++){if(["+","-"].indexOf(expressArray[j])>-1&&(j==0||specialCode2.indexOf(expressArray[length-1])>-1)){expressArray[length++]=+(expressArray[j]+expressArray[j+1]);j+=1}else{expressArray[length++]=expressArray[j]}}expressArray.length=length;return expressArray}var getExpressValue=function getExpressValue(value){if(typeof value=="string")return value.replace(/@string$/,"");return value};var setExpressValue=function setExpressValue(value){if(typeof value=="string")return value+"@string";return value};function evalValue(expressArray){var length=0,i=0;for(;i<expressArray.length;i++){if(expressArray[i]=="!"){expressArray[length]=!expressArray[++i]}else expressArray[length]=expressArray[i];length+=1}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="*"){expressArray[length-1]=getExpressValue(expressArray[length-1])*getExpressValue(expressArray[++i])}else if(expressArray[i]=="/"){expressArray[length-1]=getExpressValue(expressArray[length-1])/getExpressValue(expressArray[++i])}else if(expressArray[i]=="%"){expressArray[length-1]=getExpressValue(expressArray[length-1])%getExpressValue(expressArray[++i])}else{expressArray[length++]=expressArray[i]}}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="+"){expressArray[length-1]=setExpressValue(getExpressValue(expressArray[length-1])+getExpressValue(expressArray[++i]))}else if(expressArray[i]=="-"){expressArray[length-1]=getExpressValue(expressArray[length-1])-getExpressValue(expressArray[++i])}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]==">"){expressArray[length-1]=getExpressValue(expressArray[length-1])>getExpressValue(expressArray[++i])}else if(expressArray[i]=="<"){expressArray[length-1]=getExpressValue(expressArray[length-1])<getExpressValue(expressArray[++i])}else if(expressArray[i]=="<="){expressArray[length-1]=getExpressValue(expressArray[length-1])<=getExpressValue(expressArray[++i])}else if(expressArray[i]==">="){expressArray[length-1]=getExpressValue(expressArray[length-1])>=getExpressValue(expressArray[++i])}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="=="){expressArray[length-1]=getExpressValue(expressArray[length-1])==getExpressValue(expressArray[++i])}else if(expressArray[i]=="==="){expressArray[length-1]=getExpressValue(expressArray[length-1])===getExpressValue(expressArray[++i])}else if(expressArray[i]=="!="){expressArray[length-1]=getExpressValue(expressArray[length-1])!=getExpressValue(expressArray[++i])}else if(expressArray[i]=="!=="){expressArray[length-1]=getExpressValue(expressArray[length-1])!==getExpressValue(expressArray[++i])}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="&&"){expressArray[length-1]=getExpressValue(expressArray[length-1])&&getExpressValue(expressArray[1+i]);i+=1}else if(expressArray[i]=="||"){expressArray[length-1]=getExpressValue(expressArray[length-1])||getExpressValue(expressArray[1+i]);i+=1}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="?"){expressArray[length-1]=getExpressValue(expressArray[length-1])?getExpressValue(expressArray[i+1]):getExpressValue(expressArray[i+3]);i+=3}else expressArray[length++]=expressArray[i]}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;throw new Error("Unrecognized expression : ["+expressArray.toString()+"]")}function calcValue(target,expressArray,scope){var value=expressArray[0]in scope?scope[expressArray[0]]:target[expressArray[0]];for(var i=1;i<expressArray.length;i++){try{value=value[expressArray[i]]}catch(e){console.error({target:target,scope:scope,expressArray:expressArray,index:i});throw e}}return value}var doit1=function doit1(target,expressArray,scope){if(expressArray.indexOf("(")>-1){var newExpressArray=[],temp=[],flag=0;for(var i=0;i<expressArray.length;i++){if(expressArray[i]=="("){if(flag>0){temp.push("(")}flag+=1}else if(expressArray[i]==")"){if(flag>1)temp.push(")");flag-=1;if(flag==0){var _value=evalValue(doit1(target,temp));newExpressArray.push(isString(_value)?_value+"@string":_value);temp=[]}}else{if(flag>0)temp.push(expressArray[i]);else newExpressArray.push(expressArray[i])}}expressArray=newExpressArray}return doit2(expressArray)};var doit2=function doit2(expressArray){var hadMore=true;while(hadMore){hadMore=false;var newExpressArray=[],temp=[],flag=false;for(var i=0;i<expressArray.length;i++){if(expressArray[i]=="["&&i!=0&&expressArray[i-1]!="]"){if(flag){newExpressArray.push("[");for(var j=0;j<temp.length;j++){newExpressArray.push(temp[j])}}else{flag=true}temp=[]}else if(expressArray[i]=="]"&&flag){hadMore=true;var tempValue=evalValue(temp);var _value=newExpressArray[newExpressArray.length-1][tempValue];newExpressArray[newExpressArray.length-1]=isString(_value)?_value+"@string":_value;flag=false}else{if(flag){temp.push(expressArray[i])}else{newExpressArray.push(expressArray[i])}}}expressArray=newExpressArray}return expressArray};var doit3=function doit3(expressArray){var newExpressArray=[],temp=[];for(var i=0;i<expressArray.length;i++){if(expressArray[i]=="["){temp=[]}else if(expressArray[i]=="]"){newExpressArray.push(evalValue(temp))}else{temp.push(expressArray[i])}}return newExpressArray};function toPath(target,expressArray,scope){var newExpressArray=doit1(target,expressArray);var path;if(newExpressArray[0]!="["){path=[evalValue(newExpressArray)]}else if(newExpressArray[newExpressArray.length-1]=="]"){path=doit3(newExpressArray)}else{var lastIndex=newExpressArray.lastIndexOf("]");var tempPath=doit3(newExpressArray.slice(0,lastIndex+1));var tempArray=newExpressArray.slice(lastIndex+1);tempArray.unshift(calcValue(target,tempPath,scope));path=[evalValue(tempArray)]}return path}
/*!
   * 🔪 - 设置或获取指定对象上字符串表达式对应的值
   * https://github.com/hai2007/algorithm.js/blob/master/value.js
   *
   * author hai2007 < https://hai2007.gitee.io/sweethome >
   *
   * Copyright (c) 2020-present hai2007 走一步，再走一步。
   * Released under the MIT license
   */var getValue=function getValue(target,express,scope){if(arguments.length<3)scope={};var expressArray=analyseExpress(target,express,scope);var path=toPath(target,expressArray,scope);return calcValue(target,path,scope)};var setValue=function setValue(target,express,value,scope){if(arguments.length<4)scope={};var expressArray=analyseExpress(target,express,scope);var path=toPath(target,expressArray,scope);var _target=target;for(var i=0;i<path.length-1;i++){if(!(path[i]in _target))_target[path[i]]=isArray(_target)?[]:{};_target=_target[path[i]]}_target[path[path.length-1]]=value;return target};function merge(option,newOption){(function doMerge(express,source){for(var key in source){var newExpress=express+"['"+key+"']";if(isObject(source[key])&&!isArray(source[key])){if(!getValue(option,newExpress)){setValue(option,newExpress,{})}doMerge(newExpress,source[key])}else{setValue(option,newExpress,source[key])}}})("",newOption);return option}function chart(clunch,$ruler){var options=[];clunch.doResizeBack=function(){for(var order in options){clunch.options[order]=format(options[order],clunch,$ruler)}clunch.flag+=1};var chartManager={new:function _new(option){var order=options.length;options.push(option);setTimeout((function(){clunch.options[order]=format(option,clunch,$ruler);clunch.flag+=1}),300);return{setOption:function setOption(newOption){options[order]=merge(options[order],newOption);clunch.options[order]=format(options[order],clunch,$ruler);clunch.flag+=1}}},bind:function bind(eventType,doback){clunch.$bind(eventType,(function(target){doback(target)}))}};return chartManager}var bar=["number","json","$getLoopColors",function($number,$json,$getLoopColors){return{attrs:{order:$number(),x:$number(),y:$number(),width:$number(),height:$number(),data:$json()},region:{default:function _default(render,attr){var w1=attr.width/attr.data.values.length;for(var i=0;i<attr.data.values.length;i++){render(i,{order:attr.order}).fillRect(attr.x+i*w1,attr.y,w1,-1*attr.height)}}},link:function link(painter,attr){painter.config({fillStyle:$getLoopColors(1)[0]});var w1=attr.width/attr.data.values.length;var h1=-1/(attr.data.max-attr.data.min)*attr.height;for(var i=0;i<attr.data.values.length;i++){painter.fillRect(attr.x+w1*(i+.1),attr.y,w1*.8,(attr.data.values[i]-attr.data.min)*h1)}}}}];var line=["number","json","$getLoopColors",function($number,$json,$getLoopColors){return{attrs:{order:$number(),x:$number(),y:$number(),width:$number(),height:$number(),data:$json()},region:{default:function _default(render,attr){var w1=attr.width/attr.data.values.length;for(var i=0;i<attr.data.values.length;i++){render(i,{order:attr.order}).fillRect(attr.x+i*w1,attr.y,w1,-1*attr.height)}}},link:function link(painter,attr){painter.config({strokeStyle:$getLoopColors(1)[0]});var w1=attr.width/attr.data.values.length;var h1=-1/(attr.data.max-attr.data.min)*attr.height;painter.beginPath();for(var i=0;i<attr.data.values.length;i++){painter.lineTo(attr.x+w1*(i+.5),attr.y+(attr.data.values[i]-attr.data.min)*h1)}painter.stroke()}}}];var pie=["number","json","string","$getLoopColors","$rotate",function($number,$json,$string,$getLoopColors,$rotate){return{attrs:{order:$number(),cx:$number(),cy:$number(),radius:$number(),type:$string(),values:$json(),names:$json()},region:{default:function _default(render,attr){var allValue=0;var _iterator=_createForOfIteratorHelper(attr.values),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var value=_step.value;allValue+=value}}catch(err){_iterator.e(err)}finally{_iterator.f()}var beginDeg=Math.PI*-.5;for(var index in attr.values){var deg=attr.values[index]/allValue*Math.PI*2;render(index,{order:attr.order}).fillArc(attr.cx,attr.cy,(attr.type=="ring"?.5:0)*attr.radius,attr.radius,beginDeg,deg);beginDeg+=deg}}},link:function link(painter,attr){var colors=$getLoopColors(attr.values.length);var allValue=0;var _iterator2=_createForOfIteratorHelper(attr.values),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var value=_step2.value;allValue+=value}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var beginDeg=Math.PI*-.5;for(var index in attr.values){var deg=attr.values[index]/allValue*Math.PI*2;painter.config({fillStyle:colors[index]}).fillArc(attr.cx,attr.cy,(attr.type=="ring"?.5:0)*attr.radius,attr.radius,beginDeg,deg);if(attr.names.length>0){var _painter$beginPath$mo,_painter$beginPath;var dot1=$rotate(attr.cx,attr.cy,beginDeg+deg*.5,attr.cx+attr.radius,attr.cy);var dot2=$rotate(attr.cx,attr.cy,beginDeg+deg*.5,attr.cx+attr.radius+10,attr.cy);var distFlag=dot2[0]>attr.cx?1:-1;(_painter$beginPath$mo=(_painter$beginPath=painter.beginPath()).moveTo.apply(_painter$beginPath,_toConsumableArray(dot1))).lineTo.apply(_painter$beginPath$mo,_toConsumableArray(dot2)).lineTo(dot2[0]+distFlag*10,dot2[1]).stroke();painter.config({textAlign:distFlag>0?"left":"right"}).fillText(attr.names[index],dot2[0]+distFlag*15,dot2[1])}beginDeg+=deg}}}}];function calcFeatureCollection(data){var temp=calcFeature(data.features[0]),minX=temp.minX,maxX=temp.maxX,minY=temp.minY,maxY=temp.maxY,centers=[[(temp.maxX+temp.minX)*.5,(temp.maxY+temp.minY)*.5]],i;for(i=1;i<data.features.length;i++){temp=calcFeature(data.features[i]);if(temp.minX<minX)minX=temp.minX;if(temp.maxX>maxX)maxX=temp.maxX;if(temp.minY<minY)minY=temp.minY;if(temp.maxY>maxY)maxY=temp.maxY;centers.push([(temp.maxX+temp.minX)*.5,(temp.maxY+temp.minY)*.5])}return{minX:minX,maxX:maxX,minY:minY,maxY:maxY,centers:centers}}function calcFeature(data){if(data.geometry.type=="Polygon"){return calcPolygon(data.geometry.coordinates)}else{return calcMultiPolygon(data.geometry.coordinates)}}function calcMultiPolygon(data){var minX=data[0][0][0][0],maxX=data[0][0][0][0],minY=data[0][0][0][1],maxY=data[0][0][0][1],i,temp;for(i=0;i<data.length;i++){temp=calcPolygon(data[i]);if(temp.minX<minX)minX=temp.minX;if(temp.maxX>maxX)maxX=temp.maxX;if(temp.minY<minY)minY=temp.minY;if(temp.maxY>maxY)maxY=temp.maxY}return{minX:minX,maxX:maxX,minY:minY,maxY:maxY}}function calcPolygon(data){var minX=data[0][0][0],maxX=data[0][0][0],minY=data[0][0][1],maxY=data[0][0][1],i,j;for(i=0;i<data.length;i++){for(j=0;j<data[i].length;j++){if(minX>data[i][j][0])minX=data[i][j][0];else if(maxX<data[i][j][0])maxX=data[i][j][0];if(minY>data[i][j][1])minY=data[i][j][1];else if(maxY<data[i][j][1])maxY=data[i][j][1]}}return{minX:minX,maxX:maxX,minY:minY,maxY:maxY}}function getCenter(data){var temp;if(data.type=="FeatureCollection"){temp=calcFeatureCollection(data)}else if(data.type=="Feature"){temp=calcFeature(data)}else{throw new Error("Type error!"+JSON.stringify({function:"getCenter",type:data.type}))}return[(temp.maxX+temp.minX)*.5,(temp.maxY+temp.minY)*.5,temp.maxX-temp.minX,temp.maxY-temp.minY,temp.centers]}var drawPolygon=function drawPolygon(map,painter,data,cx,cy,type){var i,dxy;painter.beginPath();for(i=0;i<data.length;i++){dxy=map(data[i][0],data[i][1]);painter.lineTo(cx+dxy[0],cy+dxy[1])}painter.closePath()[type]()};var drawMultiPolygon=function drawMultiPolygon(map,painter,data,cx,cy,type){var i,j;if(data.type=="Polygon"){for(i=0;i<data.coordinates.length;i++){drawPolygon(map,painter,data.coordinates[i],cx,cy,type)}}else{for(i=0;i<data.coordinates.length;i++){for(j=0;j<data.coordinates[i].length;j++){drawPolygon(map,painter,data.coordinates[i][j],cx,cy,type)}}}};var getMapFun=function getMapFun($map,attr){return $map({scale:attr.scale,center:attr.center,type:"eoap"})};var initConfig=function initConfig(attr,that){var center=getCenter(attr["geo-json"]);if(attr.center==null)attr.center=[center[0],center[1]];if(attr.cx==-1)attr.cx=that._width*.5;if(attr.cy==-1)attr.cy=that._height*.5;if(attr.width==-1)attr.width=that._width;if(attr.height==-1)attr.height=that._height;if(attr.scale==null){var xScale=.5*attr.width/center[2];var yScale=.5*attr.height/center[3];attr.scale=xScale<yScale?xScale:yScale}return center[4]};var map=["number","json","string","$map","color",function($number,$json,$string,$map,$color){return{attrs:{order:$number(),"fill-color":$color("#5470c6"),"stroke-color":$color("white"),"font-color":$color("white"),type:$string("full"),cx:$number(),cy:$number(),width:$number(),height:$number(),scale:$number(null),center:$json(null),"geo-json":$json()},region:{default:function _default(render,attr){var map=getMapFun($map,attr),i;if(attr["geo-json"].type=="FeatureCollection"){for(i=0;i<attr["geo-json"].features.length;i++){drawMultiPolygon(map,render(i,{geo:attr["geo-json"].features[i],order:attr.order}).config({lineWidth:1,lineDash:[]}),attr["geo-json"].features[i].geometry,attr.cx,attr.cy,attr.type)}}else if(attr["geo-json"].type=="Feature"){drawMultiPolygon(map,render().config({lineWidth:1,lineDash:[]}),attr["geo-json"].geometry,attr.cx,attr.cy,attr.type)}}},link:function link(painter,attr){var centers=initConfig(attr,this);var map=getMapFun($map,attr);painter.config({fillStyle:attr["fill-color"],strokeStyle:attr["stroke-color"],lineWidth:1,lineDash:[]});var type=attr.type,i,textPosition;if(attr["geo-json"].type=="FeatureCollection"){for(i=0;i<attr["geo-json"].features.length;i++){if(isFunction(attr["fill-color"]))painter.config("fillStyle",attr["fill-color"].call(this,attr["geo-json"].features[i].properties,i));if(isFunction(attr["stroke-color"]))painter.config("strokeStyle",attr["stroke-color"].call(this,attr["geo-json"].features[i].properties,i));drawMultiPolygon(map,painter,attr["geo-json"].features[i].geometry,attr.cx,attr.cy,type)}}else if(attr["geo-json"].type=="Feature"){if(isFunction(attr["fill-color"]))painter.config("fillStyle",attr["fill-color"].call(this,attr["geo-json"].properties,0));if(isFunction(attr["stroke-color"]))painter.config("strokeStyle",attr["stroke-color"].call(this,attr["geo-json"].properties,0));drawMultiPolygon(map,painter,attr["geo-json"].geometry,attr.cx,attr.cy,type)}painter.config({textAlign:"center",textBaseline:"middle","font-size":10,fillStyle:attr["font-color"]});if(attr["geo-json"].type=="FeatureCollection"){for(i=0;i<attr["geo-json"].features.length;i++){if("cp"in attr["geo-json"].features[i].properties){textPosition=map(attr["geo-json"].features[i].properties.cp[0],attr["geo-json"].features[i].properties.cp[1])}else{textPosition=map(centers[i][0],centers[i][1])}painter.fillText(attr["geo-json"].features[i].properties.name,attr.cx+textPosition[0],attr.cy+textPosition[1])}}else if(attr["geo-json"].type=="Feature"){painter.fillText(attr["geo-json"].properties.name,attr.cx,attr.cy)}}}}];var initConfig$1=function initConfig(attr){var format=attr.format;if("root"in format);else format.root=function(initTree){return initTree};if("id"in format);else format.id=function(treedata){return treedata.name};if("child"in format);else format.child=function(parentTree){return parentTree.children}};var tree=["number","json","string","$tree","$move",function($number,$json,$string,$tree,$move){return{attrs:{order:$number(),x:$number(),y:$number(),data:$json(),format:$json({}),type:$string(),width:$number(),height:$number(),cx:$number(),cy:$number(),radius:$number(),"begin-deg":$number(0),deg:$number(Math.PI*2)},region:{default:function _default(render,attr){var treeData=$tree({root:attr.format.root,id:attr.format.id,child:attr.format.child,type:attr.type,width:attr.width,height:attr.height,cx:attr.cx-attr.x,cy:attr.cy-attr.y,radius:attr.radius,"begin-deg":attr["begin-deg"],deg:attr.deg})(attr.data);for(var key in treeData.node){render(key,{order:attr.order,node:treeData.node[key]}).fullCircle(attr.x+treeData.node[key].left,attr.y+treeData.node[key].top,3)}}},link:function link(painter,attr){initConfig$1(attr);var key,position,_position,pPosition,pid,deepDis;var treeData=$tree({root:attr.format.root,id:attr.format.id,child:attr.format.child,type:attr.type,width:attr.width,height:attr.height,cx:attr.cx-attr.x,cy:attr.cy-attr.y,radius:attr.radius,"begin-deg":attr["begin-deg"],deg:attr.deg})(attr.data);painter.config({strokeStyle:"gray"});for(key in treeData.node){if(key==treeData.root);else{pid=treeData.node[key].pid;pPosition=[attr.x+treeData.node[pid].left,attr.y+treeData.node[pid].top];position=[attr.x+treeData.node[key].left,attr.y+treeData.node[key].top];painter.beginPath().moveTo(pPosition[0],pPosition[1]);if(attr.type=="TB"||attr.type=="BT"){deepDis=(position[1]-pPosition[1])*.3;painter.bezierCurveTo(pPosition[0],pPosition[1]+deepDis,position[0],position[1]-deepDis,position[0],position[1])}else if(attr.type=="LR"||attr.type=="RL"){deepDis=(position[0]-pPosition[0])*.3;painter.bezierCurveTo(pPosition[0]+deepDis,pPosition[1],position[0]-deepDis,position[1],position[0],position[1])}else{painter.lineTo(position[0],position[1])}painter.stroke()}}painter.config({fillStyle:"#000","font-size":10,textBaseline:"middle"});for(key in treeData.node){position=[attr.x+treeData.node[key].left,attr.y+treeData.node[key].top];if(key==treeData.root){if(attr.type=="LR"){painter.config("textAlign","right").fillText(key,position[0]-5,position[1])}else{painter.config("textAlign","left").fillText(key,position[0]+5,position[1])}}else{if(attr.type=="LR"){painter.config("textAlign","left").fillText(key,position[0]+5,position[1])}else if(attr.type=="RL"){painter.config("textAlign","right").fillText(key,position[0]-5,position[1])}else if(attr.type=="TB"){painter.config("textAlign","left").fillText(key,position[0],position[1]+5,Math.PI*.5)}else if(attr.type=="BT"){painter.config("textAlign","left").fillText(key,position[0],position[1]-5,-Math.PI*.5)}else if(attr.type=="circle"){_position=$move(position[0]-attr.cx,position[1]-5-attr.cy,5,position[0],position[1]-5);painter.fillText(key,_position[0],_position[1],treeData.node[key].deg)}}}painter.config({fillStyle:"white",strokeStyle:"red"});for(key in treeData.node){painter.fullCircle(attr.x+treeData.node[key].left,attr.y+treeData.node[key].top,3)}}}}];var serieslist={"plain-chart-bar":bar,"plain-chart-line":line,"plain-chart-pie":pie,"plain-chart-map":map,"plain-chart-tree":tree};var server={};var options={render:image,debug:false,data:["$ruler",function($ruler){server={$ruler:$ruler};return{options:[],flag:0}}],resized:function resized(){this.doResizeBack()}};var PlainChart=function PlainChart(init){return new Promise((function(resolve){init(options,serieslist).then((function(clunch){resolve(chart(clunch,server.$ruler))}))}))};PlainChart.init=function(Clunch,el){Clunch.series(serieslist);options.el=el;return chart(new Clunch(options),server.$ruler)};if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&_typeof(module.exports)==="object"){module.exports=PlainChart}else{window.PlainChart=PlainChart}})();